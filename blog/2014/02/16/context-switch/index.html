
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Context Switch - Distributed Knowledge</title>
  <meta name="author" content="Vaibhav Gautam">

  
  <meta name="description" content="Message Passing Remote Procedure Calls (RPC) Lightweight Remote Procedure Call Distributed Shared Memory – IVY Further reading The scope of this &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://distkeys.com/blog/2014/02/16/context-switch/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
   <link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css" />
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Distributed Knowledge" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Gafata' rel='stylesheet' type='text/css'>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$$','$$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript"
   src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44705857-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
</hgroup>

</header>
  <!-- <nav role="navigation"><ul class="subscription" data-subscription="rss email">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
    <li><a href="gautam.usc@gmail.com" rel="subscribe-email" title="subscribe via email">Email</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:distkeys.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav> -->
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Context Switch</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-16T14:53:00-08:00" pubdate data-updated="true">Feb 16<span>th</span>, 2014</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><ul id="markdown-toc">
  <li><a href="#message-passing">Message Passing</a></li>
  <li><a href="#remote-procedure-calls-rpc">Remote Procedure Calls (RPC)</a></li>
  <li><a href="#lightweight-remote-procedure-call">Lightweight Remote Procedure Call</a></li>
  <li><a href="#distributed-shared-memory--ivy">Distributed Shared Memory – IVY</a></li>
  <li><a href="#further-reading">Further reading</a></li>
</ul>

<p>The scope of this post is limited to the study of context switches in various communication and synchronization primitives in distributed systems mainly focus on following:</p>

<p>•	Message Passing<br />
•	Remote Procedure Calls (RPC) <br />
•	Light weight Procedure Calls (LRPC)<br />
•	Distributed Shared Memory (DSM)<br /></p>

<!-- more -->
<p><br /></p>

<h3 id="message-passing">Message Passing</h3>

<p>Message passing is the communication primitive based on the <code class="myyellow">Client – Server architecture</code> involving communication only through a message passing. In message passing architecture the user process generates the datagram and interrupts the kernel for sending datagram to receiver. This process needs a context switch. <br /><br />
At receiving end, after receiving a datagram by the service the data is sent to application in User Space from Kernel module, which involves the context switch. Same process is done back and forth to send and receive data with respective context switching in Message passing scheme of communication.<br /><br />
Synchronization is achieved by blocking send and receives which may result in blocking the process in execution, while it receives a response from receiver, and volunteering giving up the CPU which might be argued as a context switch but in this post this mechanism is not treated as a context switch. 
<br /><br /></p>

<h3 id="remote-procedure-calls-rpc">Remote Procedure Calls (RPC)</h3>

<p>RPC communication models aims to achieve the results of normal procedure call but in distributed environment. RPC is a level of abstraction on top of message passing and since, the nature of procedure call is continuous RPC follows a synchronous communication methodology. Four components in RPC are:<br /></p>

<p>•	User – In user space<br />
•	User Stub and RPC Communication Package – In Kernel Space<br />
•	Server Stub and RPC Communication Package – In Kernel Space<br />
•	Server – In user space on remote machine<br /></p>

<p>User makes an RPC call like a normal procedure call which result in calling User stub and later the RPC communication package which is called the RPC runtime often. This process involves the context switching and the kernel takes care of RPC request using user stub and RPC runtime for marshaling data and sending to receiver.</p>

<p>At the receiving end, the receiving and unmarshal of data packet is done by RPC runtime and server stub. The data is sent to the required user process for execution. This is point of context switch at the receiving side. Same procedure happens while sending result back to sender for the RPC request. The whole process involves the <code class="myyellow">four context switches.</code> Four context switches is because the interrupt handler receives the incoming packets and delivers to the correct process. It can be reduced to even two context switches if incoming message can be delivered directly to correct process without the intervention of interrupt handler.</p>

<p><code class="myyellow">Binding</code> is the process of knowing the machine names and location which sender machine can connect for RPC operation. It can lead to increase in context switch as it is itself implemented as a separate module. In <code class="myyellow">RPC paper Grapevine</code> is used as a database for binding.  Sending and receiving communication can lead to two additional context switches on the sender side. Same is for the receiver side. 
<br /><br /></p>

<h3 id="lightweight-remote-procedure-call">Lightweight Remote Procedure Call</h3>

<p>This communication model focuses on communication between protection domains on the same machine. In a high level view, LRPC client makes a procedure call to server procedure by kernel trap which leads to a context switch. Kernel processes the request and when the called procedure completes result is returned back to the client from kernel which again leads to the context switch.<br /></p>

<p>Moving to fine granularity of LRPC, during the binding process, client makes import interface request via kernel. Kernel sends the request to server’s waiting clerk and in response waiting clerk sends response to kernel with information. Kernel then return the binding Object to client back and the whole process requires four context switches.<br /></p>

<p>LRPC minimize the use of shared data structures which internally implements its own locks so no explicit lock is required for synchronization. LRPC implements the optimization by reducing the number of context switches by caching domains on idle processors. Kernel looks for the idle processor for the client request and if found one the request is routed to the processor without any context switch. Same is done when returning the result back to client. Kernel looks for any idle client process and uses it without any context switch. If no idle domain can be found then a single processor context switching is done.
<br /><br /></p>

<h3 id="distributed-shared-memory--ivy">Distributed Shared Memory – IVY</h3>

<p>Distributed shared memory is the mode of communication in which a single address space is shared by all the processor. Processor can access any memory location at any time. In this process page size plays an important factor in performance. If the page size is big the two processes are accessing different section of same page, it reduces the performance by generating page fault. <br />
The <code class="myyellow">false sharing</code> increases the context switch.  Context switching and synchronization varies in various methodologies to handle Memory Coherent problem. <br />
<code class="myyellow">Page invalidation</code> approach for Page Synchronization invalidates all the copies of page. Next time when other process requires this page it generates the page fault hence increase the number of context switches. <br />
In <code class="myyellow">write broadcast</code> approach fault handler updates each copy. Next time process don’t generate the page fault because it has an updated copy hence reduces the context switch. In various page ownership approaches like <em>fixed, dynamic with combination of invalidate and write broadcast</em> context switches are required just from passing control from user space to kernel space and vice versa. Then the execution for <em>centralize and distributed</em> approaches can be carried away in kernel mode with different strategies for message passing.</p>

<p><br /><br /></p>

<h3 id="further-reading">Further reading</h3>

<ol>
  <li>Message Passing</li>
  <li>Distributed Shared Memory in <a href="https://www.dropbox.com/s/ukj7np5c78161at/shared%20virtual%20memory%20system.pdf" target="_blank">Ivy</a> (Integrated shared Virtual memory at
Yale) </li>
  <li><a href="https://www.dropbox.com/s/1ktdgouptq41fve/2.ImplementingRPC.pdf" target="_blank">Birrel and Nelson Remote Procedure Call</a></li>
  <li><a href="https://www.dropbox.com/s/7i4kvjg741r5idz/LRPC.pdf" target="_blank">Lightweight Remote Procedure Call</a></li>
</ol>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Vaibhav Gautam</span></span>

      








  


<time datetime="2014-02-16T14:53:00-08:00" pubdate data-updated="true">Feb 16<span>th</span>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/operating-systems/'>Operating Systems</a>, <a class='category' href='/blog/categories/systems/'>Systems</a>, <a class='category' href='/blog/categories/distributed-systems/'>distributed systems</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
   <div class="rdbWrapper" data-show-read="1" data-show-send-to-kindle="1" data-show-print="1" data-show-email="0" data-orientation="0" data-version="1"></div><script type="text/javascript">(function() {var s = document.getElementsByTagName("script")[0],rdb = document.createElement("script"); rdb.type = "text/javascript"; rdb.async = true; rdb.src = document.location.protocol + "//www.readability.com/embed.js"; s.parentNode.insertBefore(rdb, s); })();</script>
  
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://distkeys.com/blog/2014/02/16/context-switch/" data-via="_vaibhavg" data-counturl="http://distkeys.com/blog/2014/02/16/context-switch/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/01/05/scale-in-distributed-systems/" title="Previous Post: Scale in Distributed Systems">&laquo; Scale in Distributed Systems</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/02/16/naming-in-distributed-systems/" title="Next Post: Naming in Distributed Systems">Naming in Distributed Systems &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <ul id="recent_posts">
      <li class="post">
      <a href="http://distkeys.com" alt="Home"><img src="/images/Home.png"></a>
      <a href="http://distkeys.com/archives/" alt="Archives"><img src="/images/Calendar.png"></a>
      
      <a href="mailto:gautam.usc@gmail.com" alt="E-Mail"><img src="/images/mail_big.png"></a>
      
      <a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS"><img src="/images/rss.png"></a>
      </li>
  </ul>

  <script>
  (function() {
   var cx = '004567732420113844713:vbwvfm07l2y';
   var gcse = document.createElement('script');
   gcse.type = 'text/javascript';
   gcse.async = true;
   gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
   '//www.google.com/cse/cse.js?cx=' + cx;
   var s = document.getElementsByTagName('script')[0];
   s.parentNode.insertBefore(gcse, s);
   })();
</script>
<gcse:search></gcse:search>

</section>
<section>
  <h1>About Me</h1>
  <p><a href="http://www.linkedin.com/pub/vaibhav-gautam/11/663/163" target="_blank"><img src="/images/linked-in.png"></a>
  <a href="https://twitter.com/_vaibhavg" target="_blank"><img src="/images/twitter.png"></a>
  <a href="https://github.com/learnwrite" target="_blank"><img src="/images/github.png"></a>
  <a href="https://www.facebook.com/mailtovaibhav" target="_blank"><img src="/images/facebook.png"></a>
  <a href="http://www.vaibhavgautam.com" target="_blank"><img src="/images/flickr.png"></a>
  <a href="mailto:gautam.usc@gmail.com" target="_blank"><img src="/images/mail.png"></a>
  <a href="http://distkeys.com/blog/2014/02/21/reading-list/"><img src="/images/readinglist.png"></a>
  <a href="http://www.pinterest.com/gautamusc/" target="_blank"><img src="/images/pinterest.png"></a>
  <a href="http://www.quora.com/Vaibhav-Gautam" target="_blank"><img src="/images/quora.png"></a>
  </p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/07/08/boot-freebsd/">Boot FreeBSD</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/06/18/curious-case-of-recursion/">Curious Case Of Recursion</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/25/singleton/">Singleton - Design Pattern</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/18/oops/">OOPS - Object Oriented</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/03/16/file-system-scheduling-communication-and-memory-management/">File System, Scheduling, Communication and Memory Management</a>
      </li>
    
  </ul>
</section>



<section>
<h1>Categories</h1>
<ul id="categories">
<li class='category'><a href='/blog/categories/d3-js/'>D3.js (1)</a></li>
<li class='category'><a href='/blog/categories/linux/'>Linux (1)</a></li>
<li class='category'><a href='/blog/categories/octopress/'>Octopress (1)</a></li>
<li class='category'><a href='/blog/categories/operating/'>Operating (1)</a></li>
<li class='category'><a href='/blog/categories/operating-systems/'>Operating Systems (5)</a></li>
<li class='category'><a href='/blog/categories/reading-list/'>Reading List (1)</a></li>
<li class='category'><a href='/blog/categories/scale/'>Scale (1)</a></li>
<li class='category'><a href='/blog/categories/systems/'>Systems (4)</a></li>
<li class='category'><a href='/blog/categories/algorithm/'>algorithm (3)</a></li>
<li class='category'><a href='/blog/categories/algorithms/'>algorithms (3)</a></li>
<li class='category'><a href='/blog/categories/architecture/'>architecture (1)</a></li>
<li class='category'><a href='/blog/categories/array/'>array (1)</a></li>
<li class='category'><a href='/blog/categories/binary/'>binary (1)</a></li>
<li class='category'><a href='/blog/categories/binary-numbers/'>binary numbers (1)</a></li>
<li class='category'><a href='/blog/categories/debug/'>debug (1)</a></li>
<li class='category'><a href='/blog/categories/design-pattern/'>design pattern (1)</a></li>
<li class='category'><a href='/blog/categories/distributed-systems/'>distributed systems (4)</a></li>
<li class='category'><a href='/blog/categories/graph/'>graph (1)</a></li>
<li class='category'><a href='/blog/categories/interview/'>interview (1)</a></li>
<li class='category'><a href='/blog/categories/numbers/'>numbers (1)</a></li>
<li class='category'><a href='/blog/categories/object-oriented/'>object oriented (1)</a></li>
<li class='category'><a href='/blog/categories/operating-systems/'>operating systems (2)</a></li>
<li class='category'><a href='/blog/categories/recursion/'>recursion (3)</a></li>
<li class='category'><a href='/blog/categories/scale/'>scale (1)</a></li>
<li class='category'><a href='/blog/categories/sorting/'>sorting (2)</a></li>
<li class='category'><a href='/blog/categories/strings/'>strings (1)</a></li>
<li class='category'><a href='/blog/categories/system-design/'>system design (2)</a></li>
<li class='category'><a href='/blog/categories/trees/'>trees (1)</a></li>
<li class='category'><a href='/blog/categories/tries/'>tries (1)</a></li>

</ul>
</section>
<section>
<h1>Twitter</h1>
<a class="twitter-timeline" href="https://twitter.com/_vaibhavg" data-widget-id="386954016019587072">Tweets by @_vaibhavg</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - <a href="http://www.linkedin.com/pub/vaibhav-gautam/11/663/163">Vaibhav Gautam</a> -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'coolgoose85';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://distkeys.com/blog/2014/02/16/context-switch/';
        var disqus_url = 'http://distkeys.com/blog/2014/02/16/context-switch/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>




  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
